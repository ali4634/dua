<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#3498db"/>
    <meta name="description" content="روزمرہ کی دعائیں سیکھیں، یاد کریں اور تلاش کریں۔">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>روزمرہ دعائیں ایپ</title>
    <style>
        /* آپ کا سارا CSS کوڈ ویسے ہی رہے گا */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f5f5f5; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background-color: white; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); padding: 20px; }
        h1 { font-family: 'Noto Nastaliq Urdu', 'Jameel Noori Nastaleeq', 'Pak Nastaleeq', serif; color: #2c3e50; text-align: center; margin-bottom: 30px; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        /* ... باقی CSS ویسے ہی ... */
        .dua-content { font-family: 'Noto Naskh Arabic', 'Amiri', 'Scheherazade New', serif; font-size: 24px; line-height: 1.8; text-align: center; color: #1a5276; }
        
        /* === ٹیسٹنگ کے لیے اسٹائل === */
        #debug-info {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: #ffc107;
            color: black;
            padding: 10px;
            font-size: 14px;
            z-index: 9999;
            border-bottom: 2px solid #e0a800;
        }
    </style>
</head>
<body>
    <!-- === ٹیسٹنگ کے لیے ڈیبگ ایریا === -->
    <div id="debug-info">اسٹیٹس: ایپ شروع ہو رہی ہے...</div>

    <div class="container">
        <!-- آپ کا سارا HTML مواد یہاں ہے... -->
        <h1>📿 روزمرہ دعائیں ایپ</h1>
        <div class="search-container"><input type="text" id="search" placeholder="دعا تلاش کریں..."></div>
        <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all">تمام دعائیں</button>
            <button class="filter-btn" data-filter="memorized">یاد شدہ</button>
            <button class="filter-btn" data-filter="favorite">پسندیدہ</button>
        </div>
        <div id="duas-container"></div>
    </div>
    <button id="install-button">ایپ انسٹال کریں</button>

    <script>
        // === ٹیسٹنگ کے لیے ڈیبگ فنکشن ===
        const debugInfo = document.getElementById('debug-info');
        function logToScreen(message) {
            console.log(message); // کنسول میں بھی لاگ کریں
            if(debugInfo) {
                debugInfo.innerHTML += `<br>${message}`;
            }
        }

        try {
            logToScreen("اسکرپٹ چلنا شروع ہوا۔");

            const duasContainer = document.getElementById('duas-container');
            const searchInput = document.getElementById('search');
            const filterButtons = document.querySelectorAll('.filter-btn');
            const installButton = document.getElementById('install-button');

            logToScreen("تمام HTML عناصر مل گئے۔");

            const duas = [ /* آپ کی تمام دعاؤں کا ڈیٹا یہاں ہے... */ ]; // ڈیٹا کو مختصر کر دیا گیا ہے

            logToScreen(`دعاؤں کا ڈیٹا موجود ہے: ${duas.length} دعائیں ملیں۔`);
            
            function renderDuas(filter = 'all', searchTerm = '') {
                logToScreen("renderDuas فنکشن چل رہا ہے۔ فلٹر: " + filter);
                // ... آپ کا رینڈرنگ کا سارا کوڈ یہاں ...
                duasContainer.innerHTML = ''; const categories = {}; duas.forEach(dua => { if (!categories[dua.category]) categories[dua.category] = []; categories[dua.category].push(dua); }); for (const [category, categoryDuas] of Object.entries(categories)) { const categoryDiv = document.createElement('div'); categoryDiv.className = 'category'; const categoryTitle = document.createElement('div'); categoryTitle.className = 'category-title'; categoryTitle.textContent = category; categoryDiv.appendChild(categoryTitle); categoryDuas.forEach(dua => { const memorized = localStorage.getItem(`dua-${dua.id}-memorized`) === 'true'; const favorite = localStorage.getItem(`dua-${dua.id}-favorite`) === 'true'; if (filter === 'all' || (filter === 'memorized' && memorized) || (filter === 'favorite' && favorite)) { const matchesSearch = searchTerm === '' || dua.title.includes(searchTerm) || dua.arabic.includes(searchTerm) || dua.translation.includes(searchTerm); if (matchesSearch) { const duaCard = document.createElement('div'); duaCard.className = 'dua-card'; duaCard.dataset.id = dua.id; duaCard.innerHTML = ` <div class="dua-title">${dua.title}</div> <div class="dua-content">${dua.arabic}</div> <div class="dua-translation">${dua.translation}</div> <div class="dua-actions"> <button class="btn btn-memorized ${memorized ? 'active' : ''}" data-id="${dua.id}" data-action="memorized"> ${memorized ? '✓ یاد ہوگئی' : 'یاد کرنا ہے'} </button> <button class="btn btn-favorite ${favorite ? 'active' : ''}" data-id="${dua.id}" data-action="favorite"> ${favorite ? '★ پسندیدہ' : 'پسندیدہ بنائیں'} </button> </div>`; categoryDiv.appendChild(duaCard); } } }); if (categoryDiv.children.length > 1) duasContainer.appendChild(categoryDiv); }
                logToScreen("renderDuas فنکشن مکمل ہوا۔");
            }
            
            function setupEventListeners() {
                logToScreen("setupEventListeners فنکشن چل رہا ہے۔");
                // ... آپ کا ایونٹ لسنرز کا سارا کوڈ یہاں ...
                searchInput.addEventListener('input', e => { const activeFilter = document.querySelector('.filter-btn.active').dataset.filter; renderDuas(activeFilter, e.target.value); }); filterButtons.forEach(button => { button.addEventListener('click', () => { filterButtons.forEach(btn => btn.classList.remove('active')); button.classList.add('active'); renderDuas(button.dataset.filter, searchInput.value); }); }); duasContainer.addEventListener('click', e => { const button = e.target.closest('button'); if (button && (button.classList.contains('btn-memorized') || button.classList.contains('btn-favorite'))) { const id = button.dataset.id; const action = button.dataset.action; const key = `dua-${id}-${action}`; const isActive = localStorage.getItem(key) === 'true'; localStorage.setItem(key, !isActive); if (action === 'memorized') { button.textContent = !isActive ? '✓ یاد ہوگئی' : 'یاد کرنا ہے'; } else { button.textContent = !isActive ? '★ پسندیدہ' : 'پسندیدہ بنائیں'; } button.classList.toggle('active'); const activeFilter = document.querySelector('.filter-btn.active').dataset.filter; if (activeFilter !== 'all') { renderDuas(activeFilter, searchInput.value); } } });
                logToScreen("setupEventListeners فنکشن مکمل ہوا۔");
            }
            
            let deferredPrompt; 
            window.addEventListener('beforeinstallprompt', (e) => {
                logToScreen("beforeinstallprompt ایونٹ فائر ہوا۔ انسٹال بٹن دکھایا جا رہا ہے۔");
                e.preventDefault(); 
                deferredPrompt = e; 
                installButton.style.display = 'block'; 
                installButton.addEventListener('click', () => { installButton.style.display = 'none'; deferredPrompt.prompt(); deferredPrompt.userChoice.then((choiceResult) => { deferredPrompt = null; }); }); 
            });

            logToScreen("ایپ کو شروع کیا جا رہا ہے...");
            renderDuas();
            setupEventListeners();
            logToScreen("ایپ کامیابی سے شروع ہو گئی۔");

        } catch (error) {
            logToScreen(`!!! ایک خرابی واقع ہوئی: ${error.message}`);
        }
    </script>
    
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('Service Worker registered successfully:', registration);
                    })
                    .catch(err => {
                        console.error('Service Worker registration failed:', err);
                    });
            });
        }
    </script>
</body>
</html>
